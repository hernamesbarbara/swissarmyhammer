Think deeply about what is in cli, but should be moved down to the library.

In general, minimize what is in the cli other than taking input, and formatting output.