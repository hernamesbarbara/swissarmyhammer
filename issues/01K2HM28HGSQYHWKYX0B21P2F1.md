The logic for creating an abort file is duplicated. 

Do not do this -- when you need an abort file -- call the abort tool as a tool. Do not repeat the logic of the abort tool in other tools